pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
local quads={}
local angle=0.125
function _update()
	local j=0
	--angle+=1/128
	for i=0,0.75,0.25 do
	 quads[j]={
	 	x=cos(i+angle),
		 y=sin(i+angle)
		}
		j+=1
	end
end

function project(c)
 return 63.5+32*c.x,63.5-32*c.y
end

function _draw()
 cls()
 
 -- find top/bottom points
 local maxy,maxi=-512
 local miny,mini=512
 for i,c in pairs(quads) do
 	if c.y>maxy then
 	 maxy,maxi=c.y,i
 	end
 	if c.y<miny then
 	 miny,mini=c.y,i
 	end
	end

	local x0,y0=project(quads[maxi])
	local _,y1=project(quads[mini])
	
	-- left/right starting point is top
	local lx0,ly0,rx0,ry0=x0,y0,x0,y0

 --  
	mini=((maxi-1)%4+4)%4
	local lx1,ly1=project(quads[mini])
	local ldy=ly1-ly0
	local ldx=(lx1-lx0)/ldy
	
	maxi=(maxi+1)%4 
	local rx1,ry1=project(quads[maxi])
	local rdy=ry1-ry0
	local rdx=(rx1-rx0)/rdy
	printh(rdy)
	printh("rdx:"..rdx.."ldx:"..ldx)

 for y=flr(y0),flr(y1) do
  --rectfill(rx0,y,lx0,y,8)
  local dx=rx0-lx0
  line(lx0, y, rx0,y, 6)
  pset(lx0, y, 8) pset(rx0,y, 8)
  --tline(lx0,y,rx0,y,lu0,lv0,(ru0-lu0)/dx,(rv0-lv0)/dx)
  lx0+=ldx
  rx0+=rdx
  
	 if y>=flr(ly1)-1 then
 	 -- move to next segment
 		mini=((mini-1)%4+4)%4
	 	lx0,ly0=lx1,ly1
	  	lx1,ly1=project(quads[mini])
	  local ldy=ly1-ly0
	  ldx=(lx1-lx0)/ldy
	 end
	 if y>=flr(ry1)-1 then
 	 -- move to next segment
 		maxi=(maxi+1)%4
	 	rx0,ry0=rx1,ry1
	  rx1,ry1=project(quads[maxi])
	  local rdy=ry1-ry0
	  rdx=(rx1-rx0)/rdy
	 end
 end
 
 for _,c in pairs(quads) do
 	local x0,y0=project(c)
 	pset(x0,y0,7)
 end
end

__gfx__
0000000011111111cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000011111111cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070011177111ccc777cc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700011117111ccccc7cc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700011117111ccc7cccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070011177711ccc777cc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000011111111cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000011111111cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888882222222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888882222222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888777882227222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888877882227272200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888887882227772200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888777882222272200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888882222222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888882222222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000111110000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000001111111110000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000001111111111111000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000001111111111111111100000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000001111111111111111111110000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000111111111111111111111111c0000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000111111111111111111111111ccccc000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000111111111771111111111111ccccccccc00000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000111111111777777111111111ccccccccccccc0000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000111111111777777111111111ccccccccccccccccc0000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000111111111111777111111111ccccccccccccccccccccc000000000000000000000000000000000000000
00000000000000000000000000000000000000000000111111111111777111111111ccccccccccccccccccccccc7000000000000000000000000000000000000
00000000000000000000000000000000000000000000111111111111777111111111ccccccccccccccccccccccc0000000000000000000000000000000000000
0000000000000000000000000000000000000000000111111111111777111111111ccccccccc7ccccccccccccc10000000000000000000000000000000000000
0000000000000000000000000000000000000000000111111111111777111111111ccccccccc77777ccccccccc10000000000000000000000000000000000000
0000000000000000000000000000000000000000000111111111711777111111111ccccccccc777777777ccccc10000000000000000000000000000000000000
000000000000000000000000000000000000000000111111111777777111111111ccccccccccc7777777ccccc100000000000000000000000000000000000000
000000000000000000000000000000000000000000111111111777777771111111ccccccccccccccc777ccccc100000000000000000000000000000000000000
000000000000000000000000000000000000000000111111111117777777111111ccccccccccccccc777ccccc100000000000000000000000000000000000000
000000000000000000000000000000000000000000111111111111111777111111ccccccccc777ccc777ccccc100000000000000000000000000000000000000
00000000000000000000000000000000000000000111111111111111111111111ccccccccc777cccc77ccccc1000000000000000000000000000000000000000
00000000000000000000000000000000000000000811111111111111111111111ccccccccc777ccccccccccc1000000000000000000000000000000000000000
00000000000000000000000000000000000000000888881111111111111111111ccccccccc7777cccccccccc1000000000000000000000000000000000000000
00000000000000000000000000000000000000000888888888111111111111111ccccccccc77777777cccccc0000000000000000000000000000000000000000
0000000000000000000000000000000000000000888888888888811111111111cccccccccc77777777ccccc10000000000000000000000000000000000000000
0000000000000000000000000000000000000000888888888888888881111111cccccccccccccc7777ccccc10000000000000000000000000000000000000000
0000000000000000000000000000000000000000888888888888888888888111ccccccccccccccccccccccc10000000000000000000000000000000000000000
000000000000000000000000000000000000000888888888888888888888888ccccccccccccccccccccccc100000000000000000000000000000000000000000
0000000000000000000000000000000000000008888888888888888888888882222ccccccccccccccccccc100000000000000000000000000000000000000000
00000000000000000000000000000000000000088888888877888888888888822222222ccccccccccccccc100000000000000000000000000000000000000000
000000000000000000000000000000000000000888888888777777888888888222222222222ccccccccccc100000000000000000000000000000000000000000
000000000000000000000000000000000000008888888887777777778888882222222222222222ccccccc1000000000000000000000000000000000000000000
0000000000000000000000000000000000000088888888888877777788888822222222222222222222ccc1000000000000000000000000000000000000000000
00000000000000000000000000000000000000888888888888777777888888222222222222222222222228000000000000000000000000000000000000000000
00000000000000000000000000000000000000888888888888777777888888222222222222222222222228000000000000000000000000000000000000000000
00000000000000000000000000000000000008888888888888777778888882222222227222222222222280000000000000000000000000000000000000000000
00000000000000000000000000000000000008888888888888887778888882222222227772222222222280000000000000000000000000000000000000000000
00000000000000000000000000000000000008888888887888887778888882222222227772222222222280000000000000000000000000000000000000000000
00000000000000000000000000000000000008888888887777787778888882222222227772222222222200000000000000000000000000000000000000000000
00000000000000000000000000000000000088888888877777777788888822222222277722222222222800000000000000000000000000000000000000000000
00000000000000000000000000000000000088888888888777777788888822222222277722277722222800000000000000000000000000000000000000000000
00000000000000000000000000000000000088888888888888877788888822222222277722277722222800000000000000000000000000000000000000000000
00000000000000000000000000000000000888888888888888888888888222222222777777777222228000000000000000000000000000000000000000000000
00000000000000000000000000000000000788888888888888888888888222222222777777777222228000000000000000000000000000000000000000000000
00000000000000000000000000000000000000018888888888888888888222222222222277772222228000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000001888888888888888222222222222222772222228000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000188888888888222222222222222772222220000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000188888882222222222222227722222280000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000018882222222222222222222222280000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000c222222222222222222222280000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000c222222222222222222800000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000c22222222222222800000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000c2222222222800000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000c222222000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000c228000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000007000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

__map__
0102010200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1112111200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0102010200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1112111200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
